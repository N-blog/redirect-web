<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Redirecting...</title>
  <script>
    window.onload = function () {
      const pathParts = window.location.pathname.split("/").filter(Boolean);
      const targetID = pathParts.length >= 1 ? pathParts[0] : null;

      if (!targetID) {
        document.body.innerHTML = "<p style='color:red;'>IDが指定されていません。</p>";
        return;
      }

      const jsonUrl = "https://raw.githubusercontent.com/N-blog/apis/main/redirect-web/main.json?v=" + Date.now();

      fetch(jsonUrl)
        .then(response => response.json())
        .then(entries => {
          const entry = entries.find(item => item.ID === targetID);

          if (!entry || !entry.Url) {
            document.body.innerHTML = `<p style='color:red;'>指定されたID「${targetID}」が見つかりません。</p>`;
            return;
          }

          const redirectUrl = entry.Url.replace(/\/+$/, "") + "/#" + entry.ID;
          setTimeout(() => {
            window.location.href = redirectUrl;
          }, 1000);
        })
        .catch(error => {
          console.error("エラー:", error.message);
          document.body.innerHTML = "<p style='color:red;'>JSONの取得に失敗しました。</p>";
        });
    };
  </script>
</head>
<body>
  <p>リダイレクト中…</p>
</body>
</html>
